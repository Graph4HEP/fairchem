
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Fast batched inference &#8212; Open Catalyst Project Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'core/inference';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fine tuning a model" href="fine-tuning/fine-tuning-oxides.html" />
    <link rel="prev" title="Training and evaluating custom models on OCP datasets" href="model_training.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Open Catalyst Project Documentation - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Open Catalyst Project Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    ocp by Open Catalyst Project
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Quickstart &amp; Installation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Using pre-trained models in ASE</a></li>
<li class="toctree-l1"><a class="reference internal" href="gotchas.html">Common gotchas with OCP</a></li>









<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">OCP API &amp; Demo</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://open-catalyst.metademolab.com/">OCP Demo (no install required!)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ocpapi.html">ocpapi</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Released Datasets &amp; Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="datasets/oc20.html">Open Catalyst 2020 (OC20)</a></li>

<li class="toctree-l1"><a class="reference internal" href="datasets/oc22.html">Open Catalyst 2022 (OC22)</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets/odac.html">Open Direct Air Capture 2023 (ODAC23)</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_checkpoints.html">Pretrained model checkpoints</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Making your own datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ase_dataset_creation.html">Making and using ASE datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="lmdb_dataset_creation.html">Making LMDB Datasets (original format)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Model development, training, inference, finetuning</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="model_training.html">Training and evaluating custom models on OCP datasets</a></li>


<li class="toctree-l1 current active"><a class="current reference internal" href="#">Fast batched inference</a></li>


<li class="toctree-l1"><a class="reference internal" href="fine-tuning/fine-tuning-oxides.html">Fine tuning a model</a></li>

<li class="toctree-l1"><a class="reference internal" href="model_faq.html">Model FAQ</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Videos and Talks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../videos/technical_talks.html">Technical presentations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Case Studies &amp; Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorials/adsorbml_walkthrough.html">AdsorbML tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="papers_using_models.html">Studies that have leveraged OCP models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro.html">Intro and background on OCP and DFT</a></li>





<li class="toctree-l1"><a class="reference internal" href="../tutorials/OCP-introduction.html">Simple simulations using the OCP ASE calculator</a></li>




<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/NRR/NRR_toc.html">Screening catalysts with OCP</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/NRR/NRR_example.html">Using OCP to enumerate adsorbates on alloy catalyst surfaces</a></li>






</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/advanced/advanced_toc.html">Advanced OCP usage</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/advanced/fine-tuning-in-python.html">Fine-tuning with Python</a></li>



<li class="toctree-l2"><a class="reference internal" href="../tutorials/advanced/embeddings.html">Working with embeddings</a></li>



</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../legacy_tutorials/legacy_tutorials.html">Legacy [deprecated] Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../legacy_tutorials/OCP_Tutorial.html">Open Catalyst Project Tutorial Notebook</a></li>













<li class="toctree-l2"><a class="reference internal" href="../legacy_tutorials/data_preprocessing.html">OCP Data Preprocessing Tutorial</a></li>



<li class="toctree-l2"><a class="reference internal" href="../legacy_tutorials/data_visualization.html">OCP Data Visualization</a></li>

</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ocpmodels documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../autoapi/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/ocpmodels/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/ocpmodels/common/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.common</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/common/relaxation/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.common.relaxation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/common/data_parallel/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.common.data_parallel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/common/distutils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.common.distutils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/common/flags/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.common.flags</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/common/gp_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.common.gp_utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/common/hpo_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.common.hpo_utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/common/logger/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.common.logger</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/common/registry/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.common.registry</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/common/transforms/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.common.transforms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/common/tutorial_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.common.tutorial_utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/common/typing/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.common.typing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/common/utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.common.utils</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/ocpmodels/datasets/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.datasets</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/datasets/embeddings/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.datasets.embeddings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/datasets/_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.datasets._utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/datasets/ase_datasets/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.datasets.ase_datasets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/datasets/lmdb_database/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.datasets.lmdb_database</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/datasets/lmdb_dataset/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.datasets.lmdb_dataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/datasets/oc22_lmdb_dataset/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.datasets.oc22_lmdb_dataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/datasets/target_metadata_guesser/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.datasets.target_metadata_guesser</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/ocpmodels/models/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.models</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/models/equiformer_v2/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.models.equiformer_v2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/models/escn/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.models.escn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/models/gemnet/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.models.gemnet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/models/gemnet_gp/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.models.gemnet_gp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/models/gemnet_oc/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.models.gemnet_oc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/models/painn/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.models.painn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/models/scn/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.models.scn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/models/utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.models.utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/models/base/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.models.base</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/models/dimenet_plus_plus/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.models.dimenet_plus_plus</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/models/model_registry/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.models.model_registry</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/models/schnet/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.models.schnet</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/ocpmodels/modules/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.modules</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/modules/scaling/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.modules.scaling</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/modules/evaluator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.modules.evaluator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/modules/exponential_moving_average/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.modules.exponential_moving_average</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/modules/loss/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.modules.loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/modules/normalizer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.modules.normalizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/modules/scheduler/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.modules.scheduler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/modules/transforms/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.modules.transforms</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/ocpmodels/preprocessing/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.preprocessing</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/preprocessing/atoms_to_graphs/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.preprocessing.atoms_to_graphs</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/ocpmodels/tasks/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.tasks</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/tasks/task/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.tasks.task</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/ocpmodels/trainers/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.trainers</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/trainers/base_trainer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.trainers.base_trainer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpmodels/trainers/ocp_trainer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ocpmodels.trainers.ocp_trainer</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook execution times</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../execution_time.html">Notebook execution times</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Open-Catalyst-Project/ocp" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Open-Catalyst-Project/ocp/issues/new?title=Issue%20on%20page%20%2Fcore/inference.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/core/inference.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Fast batched inference</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Fast batched inference</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ase-calculator-way">The ASE calculator way</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-ase-calculator-and-main-py">Comparing ASE calculator and main.py</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="fast-batched-inference">
<h1>Fast batched inference<a class="headerlink" href="#fast-batched-inference" title="Link to this heading">#</a></h1>
<p>The ASE calculator is not necessarily the most efficient way to run a lot of computations. It is better to do a “mass inference” using a command line utility. We illustrate how to do that here.</p>
<p>In this paper we computed about 10K different gold structures:</p>
<p>Boes, J. R., Groenenboom, M. C., Keith, J. A., &amp; Kitchin, J. R. (2016). Neural network and Reaxff comparison for Au properties. Int. J. Quantum Chem., 116(13), 979–987. http://dx.doi.org/10.1002/qua.25115</p>
<p>You can retrieve the dataset below. In this notebook we learn how to do “mass inference” without an ASE calculator. You do this by creating a config.yml file, and running the <code class="docutils literal notranslate"><span class="pre">main.py</span></code> command line utility.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-f<span class="w"> </span>data.db<span class="w"> </span><span class="o">]</span><span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span>wget<span class="w"> </span>https://figshare.com/ndownloader/files/11948267<span class="w"> </span>-O<span class="w"> </span>data.db<span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2024-04-14 19:20:34--  https://figshare.com/ndownloader/files/11948267
Resolving figshare.com (figshare.com)... 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>54.77.168.55, 34.241.219.103, 2a05:d018:1f4:d003:1b62:83cf:3588:d156, ...
Connecting to figshare.com (figshare.com)|54.77.168.55|:443... 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>connected.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HTTP request sent, awaiting response... 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>302 Found
Location: https://s3-eu-west-1.amazonaws.com/pstorage-cmu-348901238291901/11948267/data.db?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAI266R7V6O36O5JUA/20240414/eu-west-1/s3/aws4_request&amp;X-Amz-Date=20240414T192034Z&amp;X-Amz-Expires=10&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=1f76cfe3d05f4decf36bc5f3ebe54ed435183c327e24677a1692a142f4bd85b3 [following]
--2024-04-14 19:20:34--  https://s3-eu-west-1.amazonaws.com/pstorage-cmu-348901238291901/11948267/data.db?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAI266R7V6O36O5JUA/20240414/eu-west-1/s3/aws4_request&amp;X-Amz-Date=20240414T192034Z&amp;X-Amz-Expires=10&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=1f76cfe3d05f4decf36bc5f3ebe54ed435183c327e24677a1692a142f4bd85b3
Resolving s3-eu-west-1.amazonaws.com (s3-eu-west-1.amazonaws.com)... 52.218.37.115, 52.92.16.32, 52.92.19.104, ...
Connecting to s3-eu-west-1.amazonaws.com (s3-eu-west-1.amazonaws.com)|52.218.37.115|:443... 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>connected.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HTTP request sent, awaiting response... 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>200 OK
Length: 43125760 (41M) [binary/octet-stream]
Saving to: ‘data.db’


data.db               0%[                    ]       0  --.-KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db               0%[                    ] 100.38K   385KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db               1%[                    ] 763.38K  1.43MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db               7%[&gt;                   ]   3.13M  3.99MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              10%[=&gt;                  ]   4.27M  4.08MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              13%[=&gt;                  ]   5.58M  4.26MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              14%[=&gt;                  ]   6.16M  3.92MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              16%[==&gt;                 ]   6.60M  3.60MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              16%[==&gt;                 ]   6.96M  3.32MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              17%[==&gt;                 ]   7.35M  3.12MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              18%[==&gt;                 ]   7.74M  2.96MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              19%[==&gt;                 ]   8.15M  2.83MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              20%[===&gt;                ]   8.46M  2.69MB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              21%[===&gt;                ]   8.76M  2.60MB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              21%[===&gt;                ]   8.97M  2.51MB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              22%[===&gt;                ]   9.29M  2.61MB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              23%[===&gt;                ]   9.62M  2.48MB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              24%[===&gt;                ]   9.94M  1.79MB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              24%[===&gt;                ]  10.27M  1.70MB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              25%[====&gt;               ]  10.51M  1.49MB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              26%[====&gt;               ]  10.85M  1.41MB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              26%[====&gt;               ]  11.08M  1.32MB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              27%[====&gt;               ]  11.38M  1.31MB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              28%[====&gt;               ]  11.63M  1.27MB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              28%[====&gt;               ]  11.90M  1.25MB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              29%[====&gt;               ]  12.10M  1.22MB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              29%[====&gt;               ]  12.29M  1.18MB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              30%[=====&gt;              ]  12.44M  1.16MB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              30%[=====&gt;              ]  12.65M  1.13MB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              31%[=====&gt;              ]  12.79M  1.10MB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              31%[=====&gt;              ]  12.94M  1.06MB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              31%[=====&gt;              ]  13.07M  1.03MB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              32%[=====&gt;              ]  13.19M   996KB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              32%[=====&gt;              ]  13.37M   959KB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              32%[=====&gt;              ]  13.49M   915KB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              33%[=====&gt;              ]  13.60M   852KB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              33%[=====&gt;              ]  13.74M   806KB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              33%[=====&gt;              ]  13.88M   772KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              34%[=====&gt;              ]  13.99M   727KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              34%[=====&gt;              ]  14.15M   705KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              34%[=====&gt;              ]  14.30M   686KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              35%[======&gt;             ]  14.43M   648KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              35%[======&gt;             ]  14.58M   643KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              35%[======&gt;             ]  14.72M   633KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              36%[======&gt;             ]  14.88M   627KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              36%[======&gt;             ]  14.99M   616KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              36%[======&gt;             ]  15.12M   611KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              37%[======&gt;             ]  15.24M   606KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              37%[======&gt;             ]  15.38M   619KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              37%[======&gt;             ]  15.51M   616KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              38%[======&gt;             ]  15.68M   630KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              38%[======&gt;             ]  15.80M   633KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              38%[======&gt;             ]  15.93M   628KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              39%[======&gt;             ]  16.08M   641KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              39%[======&gt;             ]  16.19M   638KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              39%[======&gt;             ]  16.30M   633KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              39%[======&gt;             ]  16.43M   627KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              40%[=======&gt;            ]  16.55M   625KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              40%[=======&gt;            ]  16.68M   620KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              40%[=======&gt;            ]  16.80M   615KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              41%[=======&gt;            ]  16.94M   608KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              41%[=======&gt;            ]  17.07M   612KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              41%[=======&gt;            ]  17.22M   620KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              42%[=======&gt;            ]  17.37M   629KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              42%[=======&gt;            ]  17.51M   623KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              42%[=======&gt;            ]  17.63M   616KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              43%[=======&gt;            ]  17.74M   606KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              43%[=======&gt;            ]  17.88M   606KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              43%[=======&gt;            ]  18.01M   601KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              44%[=======&gt;            ]  18.16M   606KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              44%[=======&gt;            ]  18.30M   615KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              44%[=======&gt;            ]  18.44M   618KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              45%[========&gt;           ]  18.54M   613KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              45%[========&gt;           ]  18.65M   608KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              45%[========&gt;           ]  18.74M   598KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              45%[========&gt;           ]  18.85M   596KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              46%[========&gt;           ]  18.94M   587KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              46%[========&gt;           ]  19.02M   569KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              46%[========&gt;           ]  19.12M   556KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              46%[========&gt;           ]  19.22M   547KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              46%[========&gt;           ]  19.32M   547KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              47%[========&gt;           ]  19.43M   530KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              47%[========&gt;           ]  19.54M   528KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              47%[========&gt;           ]  19.66M   524KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              48%[========&gt;           ]  19.77M   521KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              48%[========&gt;           ]  19.88M   512KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              48%[========&gt;           ]  19.97M   502KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              48%[========&gt;           ]  20.08M   491KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              49%[========&gt;           ]  20.21M   481KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              49%[========&gt;           ]  20.35M   478KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              49%[========&gt;           ]  20.49M   491KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              50%[=========&gt;          ]  20.63M   495KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              50%[=========&gt;          ]  20.72M   501KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              50%[=========&gt;          ]  20.85M   502KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              50%[=========&gt;          ]  20.96M   505KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              51%[=========&gt;          ]  21.08M   507KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              51%[=========&gt;          ]  21.22M   510KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              51%[=========&gt;          ]  21.37M   511KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              52%[=========&gt;          ]  21.51M   510KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              52%[=========&gt;          ]  21.62M   512KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              52%[=========&gt;          ]  21.72M   507KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              53%[=========&gt;          ]  21.83M   509KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              53%[=========&gt;          ]  21.93M   503KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              53%[=========&gt;          ]  22.04M   497KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              53%[=========&gt;          ]  22.16M   495KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              54%[=========&gt;          ]  22.29M   495KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              54%[=========&gt;          ]  22.40M   493KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              54%[=========&gt;          ]  22.52M   499KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              55%[==========&gt;         ]  22.65M   508KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              55%[==========&gt;         ]  22.79M   519KB/s    eta 21s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              55%[==========&gt;         ]  22.91M   525KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              56%[==========&gt;         ]  23.05M   532KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              56%[==========&gt;         ]  23.19M   539KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              56%[==========&gt;         ]  23.35M   550KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              57%[==========&gt;         ]  23.49M   562KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              57%[==========&gt;         ]  23.66M   585KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              57%[==========&gt;         ]  23.80M   596KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              58%[==========&gt;         ]  23.97M   617KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              58%[==========&gt;         ]  24.13M   640KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              59%[==========&gt;         ]  24.32M   656KB/s    eta 20s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              59%[==========&gt;         ]  24.47M   667KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              59%[==========&gt;         ]  24.65M   674KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              60%[===========&gt;        ]  24.82M   687KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              60%[===========&gt;        ]  24.94M   688KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              60%[===========&gt;        ]  25.02M   669KB/s    eta 19s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              61%[===========&gt;        ]  25.15M   665KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              61%[===========&gt;        ]  25.24M   653KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              61%[===========&gt;        ]  25.33M   641KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              61%[===========&gt;        ]  25.43M   628KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              62%[===========&gt;        ]  25.51M   607KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              62%[===========&gt;        ]  25.58M   586KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              62%[===========&gt;        ]  25.66M   567KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              62%[===========&gt;        ]  25.74M   538KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              62%[===========&gt;        ]  25.83M   518KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              63%[===========&gt;        ]  25.93M   503KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              63%[===========&gt;        ]  26.01M   489KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              63%[===========&gt;        ]  26.12M   471KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              63%[===========&gt;        ]  26.21M   457KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              63%[===========&gt;        ]  26.32M   451KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              64%[===========&gt;        ]  26.41M   448KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              64%[===========&gt;        ]  26.54M   440KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              64%[===========&gt;        ]  26.68M   439KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              65%[============&gt;       ]  26.82M   452KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              65%[============&gt;       ]  26.93M   459KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              65%[============&gt;       ]  27.07M   472KB/s    eta 18s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              66%[============&gt;       ]  27.21M   488KB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              66%[============&gt;       ]  27.32M   496KB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              66%[============&gt;       ]  27.43M   509KB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              66%[============&gt;       ]  27.54M   516KB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              67%[============&gt;       ]  27.66M   523KB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              67%[============&gt;       ]  27.79M   535KB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              67%[============&gt;       ]  27.91M   545KB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              68%[============&gt;       ]  28.04M   552KB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              68%[============&gt;       ]  28.18M   563KB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              68%[============&gt;       ]  28.30M   570KB/s    eta 17s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              69%[============&gt;       ]  28.44M   584KB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              69%[============&gt;       ]  28.58M   596KB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              69%[============&gt;       ]  28.72M   602KB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              70%[=============&gt;      ]  28.87M   604KB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              70%[=============&gt;      ]  28.97M   594KB/s    eta 16s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              70%[=============&gt;      ]  29.08M   588KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              70%[=============&gt;      ]  29.16M   572KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              71%[=============&gt;      ]  29.26M   569KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              71%[=============&gt;      ]  29.33M   554KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              71%[=============&gt;      ]  29.41M   537KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              71%[=============&gt;      ]  29.49M   531KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              71%[=============&gt;      ]  29.55M   511KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              72%[=============&gt;      ]  29.65M   505KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              72%[=============&gt;      ]  29.72M   491KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              72%[=============&gt;      ]  29.80M   481KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              72%[=============&gt;      ]  29.88M   459KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              72%[=============&gt;      ]  29.97M   449KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              73%[=============&gt;      ]  30.07M   440KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              73%[=============&gt;      ]  30.18M   416KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              73%[=============&gt;      ]  30.30M   410KB/s    eta 15s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              73%[=============&gt;      ]  30.43M   414KB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              74%[=============&gt;      ]  30.54M   412KB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              74%[=============&gt;      ]  30.65M   420KB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              74%[=============&gt;      ]  30.77M   433KB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              75%[==============&gt;     ]  30.90M   441KB/s    eta 14s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              75%[==============&gt;     ]  31.02M   465KB/s    eta 13s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              75%[==============&gt;     ]  31.16M   481KB/s    eta 13s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              76%[==============&gt;     ]  31.29M   498KB/s    eta 13s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              76%[==============&gt;     ]  31.46M   520KB/s    eta 13s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              76%[==============&gt;     ]  31.63M   544KB/s    eta 13s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              77%[==============&gt;     ]  31.77M   561KB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              77%[==============&gt;     ]  31.94M   584KB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              78%[==============&gt;     ]  32.08M   603KB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              78%[==============&gt;     ]  32.27M   630KB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              78%[==============&gt;     ]  32.43M   646KB/s    eta 12s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              79%[==============&gt;     ]  32.63M   672KB/s    eta 11s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              79%[==============&gt;     ]  32.83M   694KB/s    eta 11s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              80%[===============&gt;    ]  33.01M   709KB/s    eta 11s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              80%[===============&gt;    ]  33.19M   730KB/s    eta 11s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              81%[===============&gt;    ]  33.32M   736KB/s    eta 11s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              81%[===============&gt;    ]  33.47M   744KB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              81%[===============&gt;    ]  33.63M   749KB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              82%[===============&gt;    ]  33.79M   754KB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              82%[===============&gt;    ]  33.96M   768KB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              83%[===============&gt;    ]  34.15M   781KB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              83%[===============&gt;    ]  34.32M   785KB/s    eta 9s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              83%[===============&gt;    ]  34.51M   793KB/s    eta 9s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              84%[===============&gt;    ]  34.69M   805KB/s    eta 9s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              84%[===============&gt;    ]  34.85M   804KB/s    eta 9s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              85%[================&gt;   ]  34.99M   794KB/s    eta 9s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              85%[================&gt;   ]  35.13M   789KB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              85%[================&gt;   ]  35.27M   777KB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              86%[================&gt;   ]  35.41M   763KB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              86%[================&gt;   ]  35.57M   758KB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              86%[================&gt;   ]  35.72M   749KB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              87%[================&gt;   ]  35.88M   754KB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              87%[================&gt;   ]  36.04M   754KB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              88%[================&gt;   ]  36.19M   754KB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              88%[================&gt;   ]  36.37M   758KB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              88%[================&gt;   ]  36.54M   759KB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              89%[================&gt;   ]  36.72M   764KB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              89%[================&gt;   ]  36.90M   763KB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              90%[=================&gt;  ]  37.10M   767KB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              90%[=================&gt;  ]  37.29M   764KB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              91%[=================&gt;  ]  37.47M   773KB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              91%[=================&gt;  ]  37.68M   790KB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              92%[=================&gt;  ]  37.88M   807KB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              92%[=================&gt;  ]  38.08M   828KB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              93%[=================&gt;  ]  38.32M   854KB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              93%[=================&gt;  ]  38.52M   866KB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              94%[=================&gt;  ]  38.76M   887KB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              94%[=================&gt;  ]  38.97M   911KB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              95%[==================&gt; ]  39.12M   904KB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              95%[==================&gt; ]  39.37M   929KB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              96%[==================&gt; ]  39.57M   934KB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              96%[==================&gt; ]  39.74M   937KB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              97%[==================&gt; ]  39.96M   952KB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              97%[==================&gt; ]  40.15M   951KB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              98%[==================&gt; ]  40.32M   936KB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              98%[==================&gt; ]  40.55M   949KB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              98%[==================&gt; ]  40.71M   937KB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              99%[==================&gt; ]  40.88M   931KB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db              99%[==================&gt; ]  41.05M   923KB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data.db             100%[===================&gt;]  41.13M   918KB/s    in 54s     

2024-04-14 19:21:28 (783 KB/s) - ‘data.db’ saved [43125760/43125760]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>ase<span class="w"> </span>db<span class="w"> </span>data.db
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id|age|user |formula|calculator|  energy|natoms| fmax|pbc|  volume|charge|     mass
 1| 9y|jboes|Au55   |vasp      |-170.717|    55|0.164|TTT|3304.114| 0.000|10833.161
 2| 9y|jboes|Au55   |vasp      |-170.717|    55|0.165|TTT|3304.114| 0.000|10833.161
 3| 9y|jboes|Au55   |vasp      |-170.718|    55|0.167|TTT|3304.114| 0.000|10833.161
 4| 9y|jboes|Au55   |vasp      |-170.721|    55|0.170|TTT|3304.114| 0.000|10833.161
 5| 9y|jboes|Au55   |vasp      |-170.732|    55|0.207|TTT|3304.114| 0.000|10833.161
 6| 9y|jboes|Au55   |vasp      |-170.762|    55|0.310|TTT|3304.114| 0.000|10833.161
 7| 9y|jboes|Au55   |vasp      |-170.816|    55|0.507|TTT|3304.114| 0.000|10833.161
 8| 9y|jboes|Au55   |vasp      |-170.905|    55|0.664|TTT|3304.114| 0.000|10833.161
 9| 9y|jboes|Au55   |vasp      |-171.034|    55|0.640|TTT|3304.114| 0.000|10833.161
10| 9y|jboes|Au55   |vasp      |-171.149|    55|0.522|TTT|3304.114| 0.000|10833.161
11| 9y|jboes|Au55   |vasp      |-171.270|    55|0.177|TTT|3304.114| 0.000|10833.161
12| 9y|jboes|Au55   |vasp      |-171.282|    55|0.154|TTT|3304.114| 0.000|10833.161
13| 9y|jboes|Au55   |vasp      |-171.279|    55|0.163|TTT|3304.114| 0.000|10833.161
14| 9y|jboes|Au55   |vasp      |-171.268|    55|0.189|TTT|3304.114| 0.000|10833.161
15| 9y|jboes|Au55   |vasp      |-171.243|    55|0.329|TTT|3304.114| 0.000|10833.161
16| 9y|jboes|Au55   |vasp      |-170.717|    55|0.172|TTT|3304.114| 0.000|10833.161
17| 9y|jboes|Au55   |vasp      |-170.717|    55|0.172|TTT|3304.114| 0.000|10833.161
18| 9y|jboes|Au55   |vasp      |-170.717|    55|0.172|TTT|3304.114| 0.000|10833.161
19| 9y|jboes|Au55   |vasp      |-170.167|    55|0.182|TTT|3304.114| 0.000|10833.161
20| 9y|jboes|Au55   |vasp      |-170.167|    55|0.182|TTT|3304.114| 0.000|10833.161
Rows: 9972 (showing first 20)
Keys: config, group, identity, neural_energy, reax_energy, structure, surf, tag, train_set, volume
</pre></div>
</div>
</div>
</div>
<p>Inference on this file will be fast if we have a gpu, but if we don’t this could take a while. To keep things fast for the automated builds, we’ll just select the first 10 structures so it’s still approachable with just a CPU.
Comment or skip this block to use the whole dataset!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>cp<span class="w"> </span>data.db<span class="w"> </span>full_data.db
<span class="kn">import</span> <span class="nn">ase.db</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">with</span> <span class="n">ase</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;full_data.db&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">full_db</span><span class="p">:</span>
  <span class="k">with</span> <span class="n">ase</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;data.db&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">subset_db</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
      <span class="n">subset_db</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">full_db</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>You have to choose a checkpoint to start with. The newer checkpoints may require too much memory for this environment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ocpmodels.models.model_registry</span> <span class="kn">import</span> <span class="n">available_pretrained_models</span>
<span class="nb">print</span><span class="p">(</span><span class="n">available_pretrained_models</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;CGCNN 200k&#39;, &#39;CGCNN 2M&#39;, &#39;CGCNN 20M&#39;, &#39;CGCNN All&#39;, &#39;DimeNet 200k&#39;, &#39;DimeNet 2M&#39;, &#39;SchNet 200k&#39;, &#39;SchNet 2M&#39;, &#39;SchNet 20M&#39;, &#39;SchNet All&#39;, &#39;DimeNet++ 200k&#39;, &#39;DimeNet++ 2M&#39;, &#39;DimeNet++ 20M&#39;, &#39;DimeNet++ All&#39;, &#39;SpinConv 2M&#39;, &#39;SpinConv All&#39;, &#39;GemNet-dT 2M&#39;, &#39;GemNet-dT All&#39;, &#39;PaiNN All&#39;, &#39;GemNet-OC 2M&#39;, &#39;GemNet-OC All&#39;, &#39;GemNet-OC All+MD&#39;, &#39;GemNet-OC-Large All+MD&#39;, &#39;SCN 2M&#39;, &#39;SCN-t4-b2 2M&#39;, &#39;SCN All+MD&#39;, &#39;eSCN-L4-M2-Lay12 2M&#39;, &#39;eSCN-L6-M2-Lay12 2M&#39;, &#39;eSCN-L6-M2-Lay12All+MD&#39;, &#39;eSCN-L6-M3-Lay20All+MD&#39;, &#39;EquiformerV2 (83M) 2M&#39;, &#39;EquiformerV2 (31M) All+MD&#39;, &#39;EquiformerV2 (153M) All+MD&#39;, &#39;SchNet All forceonly&#39;, &#39;DimeNet++ All forceonly&#39;, &#39;DimeNet++-Large All&#39;, &#39;DimeNet++ 20M+Rattled&#39;, &#39;DimeNet++ 20M+MD&#39;, &#39;CGCNN 10k is2re&#39;, &#39;CGCNN 100k is2re&#39;, &#39;CGCNN All is2re&#39;, &#39;DimeNet 10k is2re&#39;, &#39;DimeNet 100k is2re&#39;, &#39;DimeNet All is2re&#39;, &#39;SchNet 10k is2re&#39;, &#39;SchNet 100k is2re&#39;, &#39;SchNet All is2re&#39;, &#39;DimeNet++ 10k is2re&#39;, &#39;DimeNet++ 100k is2re&#39;, &#39;DimeNet++ All is2re&#39;, &#39;PaiNNAll&#39;, &#39;GemNet-dTOC22&#39;, &#39;GemNet-OCOC22&#39;, &#39;GemNet-OCOC20+OC22&#39;, &#39;GemNet-OC enforce_max_neighbors_strictly=False&#39;, &#39;GemNet-OCOC20-&gt;OC22&#39;, &#39;EquiformerV2 lambda_E$=4 lambda_F$=100 OC22&#39;, &#39;SchNet&#39;, &#39;DimeNet++&#39;, &#39;PaiNN&#39;, &#39;GemNet-OC&#39;, &#39;eSCN&#39;, &#39;EquiformerV2&#39;, &#39;EquiformerV2 (Large)&#39;, &#39;Gemnet-OC (Direct)&#39;, &#39;eSCN (Direct)&#39;, &#39;EquiformerV2 (Direct)&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ocpmodels.models.model_registry</span> <span class="kn">import</span> <span class="n">model_name_to_local_file</span>

<span class="n">checkpoint_path</span> <span class="o">=</span> <span class="n">model_name_to_local_file</span><span class="p">(</span><span class="s1">&#39;GemNet-dTOC22&#39;</span><span class="p">,</span> <span class="n">local_cache</span><span class="o">=</span><span class="s1">&#39;/tmp/ocp_checkpoints/&#39;</span><span class="p">)</span>
<span class="n">checkpoint_path</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;/tmp/ocp_checkpoints/gndt_oc22_all_s2ef.pt&#39;
</pre></div>
</div>
</div>
</div>
<p>We have to update our configuration yml file with the dataset. It is necessary to specify the train and test set for some reason.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ocpmodels.common.tutorial_utils</span> <span class="kn">import</span> <span class="n">generate_yml_config</span>
<span class="n">yml</span> <span class="o">=</span> <span class="n">generate_yml_config</span><span class="p">(</span><span class="n">checkpoint_path</span><span class="p">,</span> <span class="s1">&#39;config.yml&#39;</span><span class="p">,</span>
                   <span class="n">delete</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">,</span> <span class="s1">&#39;logger&#39;</span><span class="p">,</span> <span class="s1">&#39;task&#39;</span><span class="p">,</span> <span class="s1">&#39;model_attributes&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;dataset&#39;</span><span class="p">,</span> <span class="s1">&#39;slurm&#39;</span><span class="p">],</span>
                   <span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;amp&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                           <span class="s1">&#39;gpus&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                           <span class="s1">&#39;task.dataset&#39;</span><span class="p">:</span> <span class="s1">&#39;ase_db&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;task.prediction_dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float32&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;logger&#39;</span><span class="p">:</span><span class="s1">&#39;tensorboard&#39;</span><span class="p">,</span> <span class="c1"># don&#39;t use wandb!</span>
                           <span class="c1"># Train data</span>
                           <span class="s1">&#39;dataset.train.src&#39;</span><span class="p">:</span> <span class="s1">&#39;data.db&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;dataset.train.a2g_args.r_energy&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                           <span class="s1">&#39;dataset.train.a2g_args.r_forces&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                           <span class="s1">&#39;dataset.train.select_args.selection&#39;</span><span class="p">:</span> <span class="s1">&#39;natoms&gt;5,xc=PBE&#39;</span><span class="p">,</span>
                            <span class="c1"># Test data - prediction only so no regression</span>
                           <span class="s1">&#39;dataset.test.src&#39;</span><span class="p">:</span> <span class="s1">&#39;data.db&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;dataset.test.a2g_args.r_energy&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                           <span class="s1">&#39;dataset.test.a2g_args.r_forces&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                           <span class="s1">&#39;dataset.test.select_args.selection&#39;</span><span class="p">:</span> <span class="s1">&#39;natoms&gt;5,xc=PBE&#39;</span><span class="p">,</span>
                          <span class="p">})</span>

<span class="n">yml</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/torch/cuda/amp/grad_scaler.py:126: UserWarning: torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:root:Scale factor comment not found in model
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:root:No seed has been set in modelcheckpoint or OCPCalculator! Results may not be reproducible on re-run
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PosixPath(&#39;/home/runner/work/ocp/ocp/docs/core/config.yml&#39;)
</pre></div>
</div>
</div>
</div>
<p>It is a good idea to redirect the output to a file. If the output gets too large here, the notebook may fail to save. Normally I would use a redirect like <code class="docutils literal notranslate"><span class="pre">2&amp;&gt;1</span></code>, but this does not work with the main.py method. An alternative here is to open a terminal and run it there.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> inference
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">ocpmodels.common.tutorial_utils</span> <span class="kn">import</span> <span class="n">ocp_main</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="err">!</span> <span class="n">python</span> <span class="p">{</span><span class="n">ocp_main</span><span class="p">()}</span> <span class="o">--</span><span class="n">mode</span> <span class="n">predict</span> <span class="o">--</span><span class="n">config</span><span class="o">-</span><span class="n">yml</span> <span class="p">{</span><span class="n">yml</span><span class="p">}</span> <span class="o">--</span><span class="n">checkpoint</span> <span class="p">{</span><span class="n">checkpoint_path</span><span class="p">}</span> <span class="o">--</span><span class="n">amp</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Elapsed time = </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">t0</span><span class="si">:</span><span class="s1">1.1f</span><span class="si">}</span><span class="s1"> seconds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mass-inference.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">inference</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;Total time taken:&quot;</span><span class="w"> </span><span class="s1">&#39;mass-inference.txt&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>The mass inference approach takes 1-2 minutes to run. See the output <a class="reference internal" href="#./mass-inference.txt"><span class="xref myst">here</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="o">!</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;  results_dir:&quot;</span><span class="w"> </span>mass-inference.txt
<span class="n">d</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">/s2ef_predictions.npz&#39;</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">files</span>
</pre></div>
</div>
</div>
</div>
<p>It is not obvious, but the data from mass inference is not in the same order. We have to get an id from the mass inference, and then “resort” the results so they are in the same order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;ids&#39;</span><span class="p">]])</span>
<span class="n">sind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">inds</span><span class="p">)</span>
<span class="n">inds</span><span class="p">[</span><span class="n">sind</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>To compare this with the results, we need to get the energy data from the ase db.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ase.db</span> <span class="kn">import</span> <span class="n">connect</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;data.db&#39;</span><span class="p">)</span>

<span class="n">energies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">energy</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;natoms&gt;5,xc=PBE&#39;</span><span class="p">)])</span>
<span class="n">natoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">natoms</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;natoms&gt;5,xc=PBE&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we can see the predictions. The are only ok here; that is not surprising, the data set has lots of Au configurations that have never been seen by this model. Fine-tuning would certainly help improve this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energies</span> <span class="o">/</span> <span class="n">natoms</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">][</span><span class="n">sind</span><span class="p">]</span> <span class="o">/</span> <span class="n">natoms</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;DFT&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OCP&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="the-ase-calculator-way">
<h1>The ASE calculator way<a class="headerlink" href="#the-ase-calculator-way" title="Link to this heading">#</a></h1>
<p>We include this here just to show that:</p>
<ol class="arabic simple">
<li><p>We get the same results</p></li>
<li><p>That this is much slower.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ocpmodels.common.relaxation.ase_utils</span> <span class="kn">import</span> <span class="n">OCPCalculator</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">OCPCalculator</span><span class="p">(</span><span class="n">checkpoint_path</span><span class="o">=</span><span class="n">checkpoint_path</span><span class="p">,</span> <span class="n">cpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">OCP</span><span class="p">,</span> <span class="n">DFT</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;natoms&gt;5,xc=PBE&#39;</span><span class="p">)):</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">toatoms</span><span class="p">()</span>
    <span class="n">atoms</span><span class="o">.</span><span class="n">set_calculator</span><span class="p">(</span><span class="n">calc</span><span class="p">)</span>
    <span class="n">DFT</span> <span class="o">+=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">energy</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)]</span>
    <span class="n">OCP</span> <span class="o">+=</span> <span class="p">[</span><span class="n">atoms</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Elapsed time </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">t0</span><span class="si">:</span><span class="s1">1.1</span><span class="si">}</span><span class="s1"> seconds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This takes at least twice as long as the mass-inference approach above. It is conceptually simpler though, and does not require resorting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">DFT</span><span class="p">,</span> <span class="n">OCP</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;DFT (eV/atom)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OCP (eV/atom)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="comparing-ase-calculator-and-main-py">
<h1>Comparing ASE calculator and main.py<a class="headerlink" href="#comparing-ase-calculator-and-main-py" title="Link to this heading">#</a></h1>
<p>The results should be the same.</p>
<p>It is worth noting the default precision of predictions is float16 with main.py, but with the ASE calculator the default precision is float32. Supposedly you can specify <code class="docutils literal notranslate"><span class="pre">--task.prediction_dtype=float32</span></code> at the command line to or specify it in the config.yml like we do above, but as of the tutorial this does not resolve the issue.</p>
<p>As noted above (see also <a class="reference external" href="https://github.com/Open-Catalyst-Project/ocp/issues/542">Issue 542</a>), the ASE calculator and main.py use different precisions by default, which can lead to small differences.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">][</span><span class="n">sind</span><span class="p">]</span> <span class="o">-</span> <span class="n">OCP</span> <span class="o">*</span> <span class="n">natoms</span><span class="p">))</span>  <span class="c1"># MAE</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">][</span><span class="n">sind</span><span class="p">]</span> <span class="o">-</span> <span class="n">OCP</span> <span class="o">*</span> <span class="n">natoms</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">][</span><span class="n">sind</span><span class="p">]</span> <span class="o">-</span> <span class="n">OCP</span> <span class="o">*</span> <span class="n">natoms</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">][</span><span class="n">sind</span><span class="p">]</span> <span class="o">-</span> <span class="n">OCP</span> <span class="o">*</span> <span class="n">natoms</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Here we see many of the differences are very small. 0.0078125 = 1 / 128, and these errors strongly suggest some kind of mixed precision is responsible for these differences. It is an open issue to remove them and identify where the cause is.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">][</span><span class="n">sind</span><span class="p">]</span> <span class="o">-</span> <span class="n">OCP</span> <span class="o">*</span> <span class="n">natoms</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">400</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./core"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="model_training.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Training and evaluating custom models on OCP datasets</p>
      </div>
    </a>
    <a class="right-next"
       href="fine-tuning/fine-tuning-oxides.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fine tuning a model</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Fast batched inference</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ase-calculator-way">The ASE calculator way</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-ase-calculator-and-main-py">Comparing ASE calculator and main.py</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Open Catalyst Project
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>